<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous" />
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <title>微信运动</title>
    <style>
      * {
        padding: 0;
        margin: 0;
        box-sizing: border-box;
      }
      body {
        display: flex;
        height: 100vh;
        flex-direction: column;
        padding: 10px;
      }
      .header {
        font-size: 18px;
        font-weight: 600;
        padding: 10px 0;
        border-bottom: 2px solid #eee;
      }
      .content p {
        margin-bottom: 4px;
        color: rgb(235, 86, 28);
      }
      .content {
        /* flex: 1; */
        padding: 20px 0;
        height: 30vh;
      }
      .flex-center {
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .footer {
        flex: 1;

        padding: 20px;
        border: 2px solid #eee;
        margin: 5px 5px;
      }
      .footer .input-group {
        margin-top: 10px;
      }
      .footer .submit {
        padding: 20px;
      }
      .footer .sport-title {
        font-size: 18px;
      }
      .wx-info {
        font-size: 18px;
        font-weight: 600;
        padding: 10px;
        margin: 0 5px;
        color: rgb(255, 255, 255);
        background: black;
      }
      .tip {
        position: fixed;
        height: 6vh;
        width: 100%;
        top: -90vh;
        left: 0;
        bottom: 35vh;
        right: 0;
        margin: auto;
        background: rgba(0, 0, 0, 0.281);
        transition: all 0.5s cubic-bezier(0.59, -0.43, 1, 1);
      }
      .messageShowError {
        top: 0;
        background: rgb(194, 19, 19);
        color: rgb(255, 255, 255);
      }
      .messageShowSuccess {
        top: 0;
        background: rgb(24, 172, 4);
        color: rgb(255, 255, 255);
      }
    </style>
  </head>

  <body>
    <div class="header flex-center">微信步数修改</div>
    <div class="content">
      <p>1、下载小米运动APP,安卓可在各大应用市场下载</p>
      <p>2、苹果可在App Store或其他平台下载。</p>
      <p>3、安装应用程序并注册账号后点击我第三方接入-绑定至相关应用即可</p>
      <p>4、绑定需要的应用后，在本页面输入刚刚注册的账号</p>
    </div>
    <div class="wx-info flex-center">微信公众号:失落宝藏啊</div>
    <div class="footer">
      <div class="sport-title flex-center">小米运动</div>
      <div class="input-group">
        <span class="input-group-addon">小米账号</span>
        <input type="number" class="form-control" placeholder="请输入账号" aria-describedby="basic-addon1" id="user" />
      </div>
      <div class="input-group">
        <span class="input-group-addon">小米密码</span>
        <input type="text" class="form-control" placeholder="请输入密码" aria-describedby="basic-addon1" id="password" />
      </div>
      <div class="input-group">
        <span class="input-group-addon">修改步数</span>
        <input type="number" class="form-control" placeholder="请输入步数" aria-describedby="basic-addon1" id="STEP" />
      </div>
      <div class="submit flex-center">
        <button type="button" class="btn" onclick="submit()">提交修改</button>
      </div>

      <div class="flex-center tip" id="tip">
        <span id="message"></span>
      </div>
    </div>

    <script>
      // 提交修改
      function submit() {
        let data = {
          user: document.getElementById("user").value,
          password: document.getElementById("password").value,
          STEP: document.getElementById("STEP").value,
        };

        if (data.user == "" || data.password == "" || data.STEP == "") {
          document.getElementById("tip").classList.add("messageShowError");
          document.getElementById("message").textContent = "请填写表单信息";
          setTimeout(() => {
            document.getElementById("tip").classList.remove("messageShowError");
          }, 1500);
          return;
        }
        axios
          .post("http://152.136.191.178/wechatSport/submit", data)
          .then((res) => {
            document.getElementById("message").textContent = res.data.message;
            if (res.data.success) {
              document.getElementById("tip").classList.add("messageShowSuccess");
              setTimeout(() => {
                document.getElementById("tip").classList.remove("messageShowSuccess");
              }, 1500);
            } else {
              document.getElementById("tip").classList.add("messageShowError");
              setTimeout(() => {
                document.getElementById("tip").classList.remove("messageShowError");
              }, 1500);
            }
          })
          .catch((err) => {
            document.getElementById("tip").classList.add("messageShowError");
            document.getElementById("message").textContent = "服务器发送错误";
            setTimeout(() => {
              document.getElementById("tip").classList.remove("messageShowError");
            }, 1500);
          });
      }
    </script>
  </body>
</html>
